# 🎵 찬양 PPT 병합 프로그램 - 사용 가이드

## 🚀 빠른 시작

### 1단계: 프로그램 실행
```bash
cd praise_indexer
python index.py
```

### 2단계: 초기 인덱싱 (최초 1회, 5-10분 소요)
1. 프로그램 실행 시 "데이터베이스가 비어있습니다" 메시지 확인
2. "예" 클릭 → 자동으로 `찬양가사PPT` 폴더 인덱싱 시작
3. 또는 우측 상단 "📂 폴더 인덱싱" 버튼 클릭
4. 1653개 PPT 파일의 가사 추출 및 DB 저장

### 3단계: 찬양 검색 및 선택
1. 상단 검색창에 제목 또는 가사 입력
   - 예: "주님 사랑", "나를 지으신", "감사" 등
2. 검색 결과에서 "➕ 추가" 버튼 클릭
3. 여러 찬양 선택 가능

### 4단계: 순서 변경
- ⬆ / ⬇ 버튼으로 순서 조정
- 원하는 순서대로 배치

### 5단계: PPT 생성
1. "📁 PPT 생성하기" 버튼 클릭
2. 저장 위치 및 파일명 선택
3. 자동으로 병합 완료!

---

## 💡 주요 기능

### 1. 스마트 검색
- **제목 검색**: "주님 사랑" → "주님 사랑해요", "주님을 사랑합니다"
- **가사 검색**: "나를 지으신" → 가사에 포함된 모든 찬양
- **오타 허용**: "감사합세" → "감사하세 그 선하심을"
- **초성 검색**: "ㄱㅅㅎㅅ" → "감사하세"

### 2. 여러 찬양 선택
- 검색 결과에서 원하는 찬양 여러 개 추가
- 오른쪽 패널에 선택 목록 표시

### 3. 순서 변경
- ⬆ 위로 버튼: 한 칸 위로 이동
- ⬇ 아래로 버튼: 한 칸 아래로 이동
- ❌ 삭제 버튼: 개별 삭제
- 🗑️ 전체 삭제 버튼: 모두 삭제

### 4. PPT 자동 병합
- 선택된 찬양들을 순서대로 하나의 PPT로 병합
- `temp.pptx`의 스타일(폰트, 배경, 레이아웃) 자동 적용
- 생성 후 바로 열기 가능

---

## 🎨 템플릿 커스터마이징 (temp.pptx)

### temp.pptx란?
병합된 PPT의 스타일을 결정하는 템플릿 파일

### 수정 방법
1. PowerPoint에서 `temp.pptx` 열기
2. 원하는 스타일로 편집:
   - 배경색 또는 배경 이미지
   - 폰트 이름 (예: 맑은 고딕, 나눔고딕, Arial)
   - 폰트 크기
   - 폰트 색상
   - 텍스트 정렬 (중앙, 좌, 우)
   - 텍스트 박스 위치 및 크기
3. 저장 후 프로그램 재시작

### 팁
- 첫 번째 슬라이드의 스타일이 모든 병합 슬라이드에 적용됩니다
- 여러 텍스트 박스가 있으면 순서대로 적용됩니다
- 배경 이미지를 사용하려면 템플릿에 이미지 삽입

---

## 🔍 검색 팁

### 빠르게 찾기
```
입력: "주님"
→ 500여 개 결과 표시

입력: "주님 사랑"
→ 30여 개로 좁혀짐

입력: "주님 사랑합니다"
→ 정확한 찬양 찾기
```

### 가사로 찾기
```
제목이 기억 안 날 때:

입력: "나를 지으신"
→ "나를 지으신 주님", "나를 지으신 이가 하나님" 등

입력: "거룩 거룩"
→ 가사에 "거룩 거룩"이 포함된 찬양들
```

### 오타도 OK
```
입력: "감사합세"  → "감사하세 그 선하심을" (자동 인식)
입력: "쥬님"      → "주님" 관련 찬양들
입력: "ㄱㅅ"     → "감사", "기쁨" 등
```

---

## ⚙️ 고급 사용

### 플레이리스트처럼 사용
1. 주일 예배용 찬양 검색 및 선택
2. 순서 변경 (찬양 → 경배 → 감사 순)
3. PPT 생성하여 저장
4. 매주 재사용

### 빠른 접근
- 자주 사용하는 찬양은 통계에 자동 기록
- 검색 시 점수에 반영

---

## 🛠️ 문제 해결

### Q1. "customtkinter not found" 오류
```bash
pip install customtkinter
```

### Q2. PPT 생성이 실패함
→ `temp.pptx` 파일이 같은 폴더에 있는지 확인
→ PowerPoint에서 temp.pptx가 열려있으면 닫기

### Q3. 검색 결과가 없음
→ 인덱싱이 완료되었는지 확인 (우측 상단 통계)
→ 다시 인덱싱: "📂 폴더 인덱싱" 클릭

### Q4. 한글이 깨짐
→ `.vscode/settings.json`에서 UTF-8 설정 확인

### Q5. 프로그램이 느림
→ 인덱싱 중일 수 있음 (백그라운드)
→ 너무 많은 찬양 선택 시 병합에 시간 소요

---

## 📊 성능 정보

- **검색 속도**: < 0.1초 (1653개 파일 기준)
- **인덱싱 시간**: 약 5-10분 (최초 1회)
- **병합 속도**: 찬양 1개당 약 1-2초

---

## 🎯 활용 예시

### 예시 1: 주일 예배용
1. "감사" 검색 → 감사 찬양 3개 선택
2. "경배" 검색 → 경배 찬양 2개 선택
3. "주님" 검색 → 송축 찬양 2개 선택
4. 순서 조정 후 PPT 생성
5. → 7개 찬양이 하나의 PPT로!

### 예시 2: 특별 집회용
1. 주제에 맞는 가사 검색
2. 예: "사랑합니다" → 사랑 고백 찬양들
3. 선택 및 병합
4. → 통일된 스타일의 찬양 PPT 완성

---

## 📝 참고

- 병합된 PPT는 temp.pptx 스타일을 따릅니다
- 원본 PPT 파일은 변경되지 않습니다
- 데이터베이스는 `praise_index.db` 파일에 저장됩니다
- 한번 인덱싱하면 검색이 매우 빠릅니다

---

## 🎉 Enjoy!

이제 예배 준비가 훨씬 편리해집니다! 🙏

